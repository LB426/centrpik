<% provide(:title, "Редактор теста") %>
<div class="center"><h3>Редактирование теста</h3></div>
<div class="highlight">
  <%= form_tag(test_update_path(@test), method: "patch") do -%>
	<div class="row">
	  <div class="col-md-12">
		<div class="form-group">
		  <label>название теста</label>
		  <%= text_field_tag('name', @test.name, :class => "form-control") %>
		</div>
	  </div>
	</div>
	<div class="row">
		<div class="col-md-3">
		  <%= submit_tag "Сохранить название теста", class: "btn btn-primary" %>
		</div>
		<div class="col-md-2 col-md-offset-7">
		  <button class="btn btn-primary" id="AddQuestionToTest">
			Добавить вопрос
		  </button>
		</div>
	</div>
  <% end -%>
</div>

<div class="highlight hidden" id="NewQuestion">
  <div class="row">
	<div class="col-md-12">

	  <%= form_tag(test_questions_create_path(@test), multipart: true) do -%>
		<div class="form-group">
		  <label>вопрос</label>
		  <input class="form-control input-lg" placeholder="введите вопрос" name="question">
		</div>
		
		<div id="QuestionsAndAnswers" name="NewQuestionNewAnswer">
		  <div class="form-group bs-callout bs-callout-info">
			<div class="row">
			  <div class="col-xs-12">
				<label>ответ</label>
				<input class="form-control input-sm" placeholder="введите ответ" name="answers[1][text]">
			  </div>
			</div>
			<div class="row">
			  <div class="col-xs-12">
				<div class="myborder">
				  <code>ответ верный? </code>
				  <strong>Да </strong>
				  <input type="radio" name="answers[1][right]" value="YES">
				  <strong>Нет</strong>
				  <input type="radio" name="answers[1][right]" value="NO" checked="checked">
				</div>
			  </div>
			</div>
		  </div>
		</div>
		
		<div class="row">
		  <div class="col-xs-2">
			<%= submit_tag "Сохранить вопрос", class: "btn btn-primary" %>
		  </div>
		  <div class="col-xs-2 col-md-offset-8">
			<button class="btn btn-success"
				    id="1"
				    name="AddAnswerToTestQuestion">
			  Добавить ответ
			</button>
		  </div>
		</div>
	  <% end -%>

	</div>
  </div>
</div>
<script>
var acounter = 1 ;
</script>


<div class="highlight">

  <% @questions.each do |question| %>
  
  <div class="row" id="QBtn_<%= question.id %>">
	<div class="col-md-12">
	  <button class="btn btn-default btn-block" type="submit" name="OpenQuestionBtn" id="<%= question.id %>">
		<span class="caret"></span> <%= question.question %>
	  </button>
	</div>
  </div>

  <div class="highlight hidden" id="QBlk_<%= question.id %>">
	<div class="row">
	  <div class="col-md-12">
		<button type="button" class="close" aria-label="Close" name="CloseQuestionBtn" id="<%= question.id %>">
		  <span aria-hidden="true">&times;</span>
		</button>
	  </div>
	  <div class="col-md-12">
		<%= form_tag(test_questions_update_path(@test,question), method: "patch") do -%>
		  <div class="form-group">
			<label>вопрос</label>
			<%= text_field_tag('question', question.question,
							   :class => "form-control input-sm") %>
		  </div>
		  <% counter = 0 %>
		  <% answers = question.answers.all.order(:id => "asc") %>
		  <% answers.each do |answer| %>
			<% counter = counter + 1 %>
		  <div id="QuestionsAndAnswers">
			<blockquote>
			  <div class="form-group">
				<label>ответ <%= counter %></label>
				<input class="form-control input-sm"
					   value="<%= answer.ans_text %>"
					   name="answers[<%= answer.id %>][text]">
				<div class="row">
				  <div class="col-xs-12">
					<div class="myborder">
					  <code>ответ верный? </code>
					  
					  <% if answer.proper %>
						<strong>Да</strong>
						<input type="radio" name="answers[<%= answer.id %>][right]"
							                value="YES" checked>
						<strong>Нет</strong>
						<input type="radio" name="answers[<%= answer.id %>][right]"
							                value="NO">
					  <% else %>
						<strong>Да</strong>
						<input type="radio" name="answers[<%= answer.id %>][right]"
							                value="YES">
						<strong>Нет</strong>
						<input type="radio" name="answers[<%= answer.id %>][right]"
							                value="NO" checked>
					  <% end %>

					</div>
				  </div>
				</div>		  
			  </div>
			</blockquote>
		  </div>
		  <% end %>

		  <div class="row">
			<div class="col-md-2">
			  <%= submit_tag "Сохранить вопрос", class: "btn btn-primary" %>
			</div>
			<div class="col-md-2 col-md-offset-8">			
			  <button class="btn btn-success" id="AddAnswerToTestQuestion">
				Добавить ответ
			  </button>
			</div>
		  </div>

		<% end -%>
	  </div>
	</div>
  </div>
  &nbsp;
  <% end %>
  
</div>
